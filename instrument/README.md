instrument: Auto Metrics

[![Build Status](https://github.com/crossnokaye/micro/workflows/CI/badge.svg?branch=main&event=push)](https://github.com/crossnokaye/micro/actions?query=branch%3Amain+event%3Apush)
![Coverage](https://img.shields.io/badge/Coverage-93.7%25-brightgreen)

## Overview

Package `instrument` provides a convenient way to add OpenTelemetry metrics to
Goa services. The following example shows how to use the package:

```go
handler := instrument.HTTP(handler, meter, svc.ServiceName, svc.MethodNames)
// ... Use handler to serve HTTP requests

uinter := instrument.UnaryInterceptor(meter, svc.ServiceName, svc.MethodNames)
sinter := instrument.StreamInterceptor(meter, svc.ServiceName, svc.MethodNames)
// ... Use uinter and sinter to create the gRPC server
```

Where `svc` is the Goa generated service package and `ServiceName` and
`MethodNames` are global variables generated by Goa that contain the service and
method names respectively.

## HTTP Metrics

The `HTTP` function creates the following metrics:

* `http.request.count`: Counter of requests.
* `http.4xxresponse.count`: Counter of 4xx responses.
* `http.5xxresponse.count`: Counter of 5xx responses.
* `http.request.duration.ms`: Histogram of HTTP request durations with buckets defined in milliseconds.
* `http.request.size.bytes`: Histogram of HTTP request sizes with buckets defined in bytes.
* `http.response.size.bytes`: Histogram of HTTP response sizes with buckets defined in bytes.

The histogram buckets can be specified using the `WithRequestDurationBuckets`,
`WithRequestSizeBuckets` and `WithResponseSizeBuckets` functions. The default
buckets are:

* `{1, 50, 200, 500, 1000, 2000, 5000, 10000, +Inf}` for request duration.
* `{1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, +Inf}` for request and response size.

```go
durationBuckets := []float64{1, 50, 200, 500, 1000, 2000, 5000, 10000, -1}
requestSizeBuckets := []float64{1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, -1}
responseSizeBuckets := []float64{1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, -1}
err := instrument.HTTP(svr, meter, svc.ServiceName, svc.MethodNames,
    instrument.WithRequestDurationBuckets(durationBuckets),
    instrument.WithRequestSizeBuckets(requestSizeBuckets),
    instrument.WithResponseSizeBuckets(responseSizeBuckets))
```

## GRPC Metrics

The `UnaryInterceptor` and `StreamInterceptor` functions create the following
metrics:

* `grpc.request.count`: Counter of requests.
* `grpc.error.count`: Counter of error responses.
* `grpc.request.duration.ms`: Histogram of gRPC request durations with buckets defined in milliseconds.

The histogram buckets can be specified using the `WithRequestDurationBuckets`. The default
buckets are `{1, 50, 200, 500, 1000, 2000, 5000, 10000, +Inf}`.